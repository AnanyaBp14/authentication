<!doctype html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Mocha~Mist ‚òÅÔ∏è ‚Äî Customer Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap');

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: "Poppins", sans-serif;
    }

    body {
      background: #fbf7f1;
      color: #4c3a2f;
    }

    /* HEADER */
    header {
      background: rgba(255, 255, 255, 0.9);
      backdrop-filter: blur(10px);
      padding: 1rem 2rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
      position: sticky;
      top: 0;
      z-index: 20;
      border-bottom: 2px solid #e9dfd5;
    }

    header .logo {
      font-size: 1.4rem;
      font-weight: 600;
      color: #6b4024;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    header .logo span {
      font-size: 1.8rem;
    }

    nav a {
      margin-left: 1.5rem;
      text-decoration: none;
      font-weight: 500;
      color: #4c3a2f;
      transition: 0.2s;
    }

    nav a:hover,
    nav a.active {
      color: #c49a6c;
    }

    #cartCount {
      background: #6b4024;
      color: white;
      padding: 2px 6px;
      border-radius: 50%;
      font-size: 0.7rem;
      margin-left: 5px;
    }

    section {
      padding: 2.5rem 5%;
      animation: fadeIn 0.6s ease;
    }

    h2 {
      color: #6b4024;
      font-size: 1.8rem;
      margin-bottom: 0.4rem;
      font-weight: 600;
    }

    p.subtitle {
      color: #8a7b6f;
      margin-bottom: 1.5rem;
    }

    /* MENU GRID */
    .menu-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 1.8rem;
    }

    .coffee-card {
      background: #fff;
      border-radius: 18px;
      overflow: hidden;
      box-shadow: 0 6px 20px rgba(0,0,0,0.08);
      transition: 0.3s;
    }

    .coffee-card:hover {
      transform: translateY(-6px);
      box-shadow: 0 10px 25px rgba(0,0,0,0.12);
    }

    .coffee-card img {
      width: 100%;
      height: 170px;
      object-fit: cover;
    }

    .details {
      padding: 1rem 1.2rem;
    }

    .details h3 {
      font-size: 1.1rem;
      font-weight: 600;
      color: #4a3323;
      margin-bottom: 0.2rem;
    }

    .details p {
      font-size: 0.9rem;
      color: #7b6a58;
      margin-bottom: 0.8rem;
    }

    .price {
      background: #f6ebe0;
      padding: 4px 10px;
      border-radius: 8px;
      font-size: 0.85rem;
      color: #6b4024;
      float: right;
    }

    .coffee-card button {
      width: 100%;
      background: #6b4024;
      color: #fff;
      padding: 0.8rem;
      border: none;
      border-radius: 0 0 18px 18px;
      cursor: pointer;
      transition: 0.3s;
      font-weight: 500;
    }

    .coffee-card button:hover {
      background: #4d2c18;
    }

    /* CART SECTION */
    .cart-container {
      display: flex;
      gap: 2rem;
      flex-wrap: wrap;
    }

    .cart-items {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .cart-item {
      display: flex;
      align-items: center;
      gap: 1rem;
      background: #fff;
      padding: 1rem;
      border-radius: 14px;
      box-shadow: 0 4px 14px rgba(0,0,0,0.08);
    }

    .cart-item img {
      width: 70px;
      height: 70px;
      border-radius: 12px;
      object-fit: cover;
    }

    .cart-info h4 {
      margin-bottom: 0.2rem;
      color: #6b4024;
    }

    .qty-controls button {
      width: 28px;
      height: 28px;
      background: #efe6dd;
      border-radius: 50%;
      border: none;
      cursor: pointer;
    }

    .remove-btn {
      color: #c74f4f;
      cursor: pointer;
      background: none;
      border: none;
      font-size: 1.3rem;
    }

    /* ORDER SUMMARY */
    .order-summary {
      width: 300px;
      background: #fff;
      padding: 1.5rem;
      border-radius: 16px;
      box-shadow: 0 4px 14px rgba(0,0,0,0.08);
      height: fit-content;
    }

    .summary-box {
      display: flex;
      justify-content: space-between;
      margin-bottom: 0.4rem;
      font-size: 0.95rem;
    }

    .order-summary button {
      width: 100%;
      padding: 0.8rem;
      background: #6b4024;
      color: #fff;
      border: none;
      border-radius: 10px;
      font-size: 1rem;
      cursor: pointer;
      margin-top: 1rem;
    }

    .order-summary button:hover {
      background: #4b2b16;
    }

    /* ORDERS */
    .order-card {
      background: #fff;
      padding: 1.5rem;
      border-radius: 16px;
      box-shadow: 0 4px 14px rgba(0,0,0,0.08);
      margin-bottom: 1.4rem;
    }

    .status {
      font-weight: 600;
    }

    .progress-container {
      height: 8px;
      border-radius: 5px;
      background: #eee2d6;
      margin-top: 0.6rem;
      overflow: hidden;
    }

    .progress-bar {
      height: 8px;
      background: linear-gradient(to right, #6b4024, #c49a6c);
      width: 0%;
      transition: width 0.7s ease;
    }

    footer {
      text-align: center;
      padding: 1rem;
      margin-top: 2rem;
      color: #8a7b6f;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>

</head>

<body>

<header>
  <div class="logo"><span>‚òï</span> Mocha~Mist</div>
  <nav>
    <a onclick="showSection('menu')" class="active">Menu</a>
    <a onclick="showSection('cart')">Cart <span id="cartCount">0</span></a>
    <a onclick="showSection('orders')">Orders</a>
    <a href="index.html">Logout</a>
  </nav>
</header>

<!-- MENU -->
<section id="menuSection">
  <h2>Our Menu</h2>
  <p class="subtitle">Handcrafted coffee, made fresh for you</p>
  <div class="menu-grid" id="menuGrid"></div>
</section>

<!-- CART -->
<section id="cartSection" style="display:none;">
  <h2>Your Cart</h2>
  <p class="subtitle">Review your order</p>

  <div class="cart-container">
    <div class="cart-items" id="cartItems"></div>

    <div class="order-summary">
      <div class="summary-box"><span>Subtotal</span><span id="subtotal">‚Çπ0.00</span></div>
      <div class="summary-box"><span>Tax (8%)</span><span id="tax">‚Çπ0.00</span></div>
      <div class="summary-box"><b>Total</b><b id="total">‚Çπ0.00</b></div>

      <button onclick="placeOrder()">Place Order ‚Üí</button>
    </div>
  </div>
</section>

<!-- ORDERS -->
<section id="ordersSection" style="display:none;">
  <h2>Order Tracking</h2>
  <p class="subtitle">Track all your coffee orders</p>
</section>

<footer>¬© 2025 Mocha~Mist ‚Äî All Rights Reserved</footer>

<script>
  /* YOUR FULL BACKEND + JS LOGIC (UNCHANGED) */
  /* ‚Äî I will NOT modify anything below this line ‚Äî */

  /* Load menu data */
  let menu = JSON.parse(localStorage.getItem("menu")) || [
    { name: "Espresso", price: 150, desc: "Strong and bold shot of pure coffee" },
    { name: "Cappuccino", price: 200, desc: "Espresso with steamed milk and foam"},
    { name: "Iced Americano", price: 170, desc: "Espresso with cold water and ice" },
    { name: "Mocha", price: 240, desc: "Chocolate and espresso perfection" },
    { name: "Filter Coffee", price: 100, desc: "Classic South Indian filter blend" },
    { name: "Hazelnut Latte", price: 260, desc: "Espresso infused with nutty hazelnut"},
    { name: "Iced Coffee", price: 180, desc: "Chilled espresso blended with cold water" },
    { name: "Cafe Macchiato", price: 220, desc: "Espresso with frothy milk"},
  ];

  let cart = [];
  let orders = JSON.parse(localStorage.getItem("orders")) || [];

  const menuGrid = document.getElementById("menuGrid");
  const cartItems = document.getElementById("cartItems");
  const cartCount = document.getElementById("cartCount");

  function renderMenu() {
    menuGrid.innerHTML = "";
    menu.forEach((item, i) => {
      const card = document.createElement("div");
      card.className = "coffee-card";
      card.innerHTML = `
        <img src="${item.img}">
        <div class="details">
          <h3>${item.name} <span class="price">‚Çπ${item.price}</span></h3>
          <p>${item.desc}</p>
          <button onclick="addToCart(${i})">+ Add to Cart</button>
        </div>`;
      menuGrid.appendChild(card);
    });
  }

  function addToCart(i) {
    const existing = cart.find(c => c.name === menu[i].name);
    if (existing) existing.qty++;
    else cart.push({ ...menu[i], qty: 1 });
    updateCart();
  }

  function updateCart() {
    cartCount.textContent = cart.reduce((a, b) => a + b.qty, 0);
    cartItems.innerHTML = "";

    let subtotal = 0;

    cart.forEach((item, idx) => {
      subtotal += item.price * item.qty;

      const div = document.createElement("div");
      div.className = "cart-item";
      div.innerHTML = `
        <img src="${item.img}">
        <div class="cart-info">
          <h4>${item.name}</h4>
          <p>‚Çπ${item.price}</p>
          <div class="qty-controls">
            <button onclick="changeQty(${idx}, -1)">‚àí</button>
            <span>${item.qty}</span>
            <button onclick="changeQty(${idx}, 1)">+</button>
          </div>
        </div>
        <span>‚Çπ${item.price * item.qty}</span>
        <button class="remove-btn" onclick="removeItem(${idx})">üóëÔ∏è</button>
      `;
      cartItems.appendChild(div);
    });

    const tax = subtotal * 0.08;
    document.getElementById("subtotal").textContent = "‚Çπ" + subtotal.toFixed(2);
    document.getElementById("tax").textContent = "‚Çπ" + tax.toFixed(2);
    document.getElementById("total").textContent = "‚Çπ" + (subtotal + tax).toFixed(2);
  }

  function changeQty(i, val) {
    cart[i].qty += val;
    if (cart[i].qty <= 0) cart.splice(i, 1);
    updateCart();
  }

  function removeItem(i) {
    cart.splice(i, 1);
    updateCart();
  }

  function placeOrder() {
    if (cart.length === 0) return alert("Cart empty!");

    const subtotal = cart.reduce((a, b) => a + b.price * b.qty, 0);
    const total = subtotal + subtotal * 0.08;

    const order = {
      id: Date.now(),
      time: new Date().toLocaleString(),
      items: [...cart],
      total: total.toFixed(2),
      status: "Preparing"
    };

    orders.push(order);
    localStorage.setItem("orders", JSON.stringify(orders));

    cart = [];
    updateCart();
    showSection("orders");
    renderOrders();
  }

  function renderOrders() {
    const section = document.getElementById("ordersSection");
    section.innerHTML = `<h2>Order Tracking</h2><p class="subtitle">Track your orders</p>`;

    const sortedOrders = [...orders].sort((a, b) => b.id - a.id);

    sortedOrders.forEach(order => {
      const div = document.createElement("div");
      div.className = "order-card";

      div.innerHTML = `
        <div><b>Order #${order.id}</b>
        <span class="status" style="float:right;color:${getStatusColor(order.status)}">${order.status}</span></div>
        <p style="color:#7b6a58;font-size:0.9rem;">${order.time}</p>

        <ul style="margin-top:0.7rem;color:#6b4024;"> 
          ${order.items.map(i => `<li>${i.name} √ó${i.qty}</li>`).join("")}
        </ul>

        <p style="margin-top:0.7rem;"><b>Total:</b> ‚Çπ${order.total}</p>

        <div class="progress-container">
          <div class="progress-bar" style="width:${getProgress(order.status)}"></div>
        </div>
      `;

      section.appendChild(div);
    });
  }

  function getProgress(status) {
    return status === "Preparing" ? "33%" : status === "Ready" ? "66%" : "100%";
  }

  function getStatusColor(status) {
    return status === "Preparing" ? "#caa354" : status === "Ready" ? "#6b4024" : "green";
  }

  function showSection(sec) {
    document.getElementById("menuSection").style.display = sec === "menu" ? "block" : "none";
    document.getElementById("cartSection").style.display = sec === "cart" ? "block" : "none";
    document.getElementById("ordersSection").style.display = sec === "orders" ? "block" : "none";

    if (sec === "orders") renderOrders();
  }

  renderMenu();
  renderOrders();

  window.addEventListener("storage", () => {
    menu = JSON.parse(localStorage.getItem("menu")) || menu;
    renderMenu();
  });
</script>

</body>
</html>

